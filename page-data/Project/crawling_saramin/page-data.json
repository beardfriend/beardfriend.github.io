{"componentChunkName":"component---src-templates-blogpost-tsx","path":"/Project/crawling_saramin/","result":{"data":{"markdownRemark":{"html":"<p><strong>💡목표</strong></p>\n<ul>\n<li><strong>디자인</strong></li>\n<li>\n<p><strong>Contact 페이지 배포</strong></p>\n<ul>\n<li>express, ejs로 간단하게</li>\n<li>사용자가 Form Submit 시 나에게 Mail 발송</li>\n</ul>\n</li>\n<li>\n<p><strong>사람인 크롤링</strong></p>\n<ul>\n<li>회사명, 홈페이지주소</li>\n<li>DB에 중복 체크 후 저장</li>\n<li>회사명, 홈페이지주소 엑셀로 저장.</li>\n</ul>\n</li>\n<li>\n<p><strong>메일보내기</strong></p>\n<ul>\n<li>DB에 있는 메일</li>\n<li>보낸 메일 체크</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h1 id=\"1-디자인\" style=\"position:relative;\">1. 디자인<a href=\"#1-%EB%94%94%EC%9E%90%EC%9D%B8\" aria-label=\"1 디자인 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p><img src=\"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&#x26;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fc1M6pP%2FbtrqvApAsMx%2FBGJZu8Z51WRHYnV5N2PiI0%2Fimg.jpg\" alt=\"107\"></p>\n<p>주로 사용한 색상 : #777fd4, #92bcec, #1d2e3e<br>\n제작 툴 : Figma</p>\n<h1 id=\"2-Contact-페이지-배포\" style=\"position:relative;\">2. Contact 페이지 배포<a href=\"#2-Contact-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%B0%B0%ED%8F%AC\" aria-label=\"2 Contact 페이지 배포 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>제작 : express-generator<br>\n언어 : js<br>\n배포 : Heroku<br>\n데이터베이스 : Mongodb</p>\n<p>Mongoose를 사용했고, 배포는 MongoDB Cloud를 사용하였다.</p>\n<p>아주 간단하다.<br>\nUser스키마를 만들어주고<br>\n폼을 통해 요청을 받는다.<br>\n받은 요청을 내용을 디비에 저장한다.<br>\n저장이 잘 되면 나에게 메일을 보낸다.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"javascript\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">user</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">User</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">user</span><span class=\"mtk1\">.</span><span class=\"mtk12\">companyname</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">body</span><span class=\"mtk1\">.</span><span class=\"mtk12\">company</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">user</span><span class=\"mtk1\">.</span><span class=\"mtk12\">email</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">body</span><span class=\"mtk1\">.</span><span class=\"mtk12\">email</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">user</span><span class=\"mtk1\">.</span><span class=\"mtk12\">tel</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">body</span><span class=\"mtk1\">.</span><span class=\"mtk12\">tel</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">user</span><span class=\"mtk1\">.</span><span class=\"mtk11\">save</span><span class=\"mtk1\">().</span><span class=\"mtk11\">then</span><span class=\"mtk1\">(() </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk10\">console</span><span class=\"mtk1\">.</span><span class=\"mtk11\">log</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;success&#39;</span><span class=\"mtk1\">));</span></span></span></code></pre>\n<p>메일 보내는 건, nodemailer를 사용하였고, 워낙 예제가 많기 떄문에 생략</p>\n<h1 id=\"3-사람인-크롤링\" style=\"position:relative;\">3. 사람인 크롤링<a href=\"#3-%EC%82%AC%EB%9E%8C%EC%9D%B8-%ED%81%AC%EB%A1%A4%EB%A7%81\" aria-label=\"3 사람인 크롤링 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>크롤링은 언제나 긴장된다.<br>\n자칫하면 영업방해가 될 수 있기도, 무단수집이 될 수도 있다.<br>\n소규모의 데이터만 수집하기 때문에 문제가 없을거라 판단해 진행했다.</p>\n<h2 id=\"31-회사명-홈페이지-주소-수집\" style=\"position:relative;\">3.1. 회사명, 홈페이지 주소 수집<a href=\"#31-%ED%9A%8C%EC%82%AC%EB%AA%85-%ED%99%88%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%A3%BC%EC%86%8C-%EC%88%98%EC%A7%91\" aria-label=\"31 회사명 홈페이지 주소 수집 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>언어 : python</p>\n<p>BeautifulSoup와 requests, pymysql이 주된 라이브러리다.<br>\n빠른 코딩이 목적이라 코드는 대충짰다.</p>\n<p>처음 크롤러를 실행할 때, 테이블이 없으면 테이블을 생성하게끔 해놨다.<br>\n그리고 숫자 입력을 받아 필요에 맞게 프로그램을 실행할 수 있도록 분기처리를 해놨다.</p>\n<hr>\n<p>사람인 채용페이지에 들어가서 각 채용공고페이지 주소를 수집한다.<br>\n하나하나 들어가서 회사 이름과, 홈페이지 주소를 긁어 오는데,<br>\n회사명이 DB에 없으면 INSERT를 하고 아니면 그냥 넘긴다.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"python\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">crawling</span><span class=\"mtk1\">(</span><span class=\"mtk12\">maxPage</span><span class=\"mtk1\">, </span><span class=\"mtk12\">cursor</span><span class=\"mtk1\">, </span><span class=\"mtk12\">db</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> pagenumber </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, maxPage):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> pagenumber == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            url = (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                mainUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                + </span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;/zf_user/jobs/list/domestic?page=1&amp;loc_mcd=101000&amp;cat_mcls=21&amp;isAjaxRequest=0&amp;page_count=50&amp;sort=RL&amp;type=domestic&amp;is_param=1&amp;isSearchResultEmpty=1&amp;isSectionHome=0&amp;searchParamCount=1#searchTitle&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        url = (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            mainUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            + </span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;/zf_user/jobs/list/domestic?page=</span><span class=\"mtk4\">{</span><span class=\"mtk1\">pagenumber + </span><span class=\"mtk7\">1</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&amp;loc_mcd=101000&amp;cat_mcls=21&amp;isAjaxRequest=0&amp;page_count=50&amp;sort=RL&amp;type=domestic&amp;is_param=1&amp;isSearchResultEmpty=1&amp;isSectionHome=0&amp;searchParamCount=1#searchTitle&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        response = requests.get(url)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> response.status_code == </span><span class=\"mtk7\">200</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            html = response.text</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            soup = BeautifulSoup(html, </span><span class=\"mtk8\">&quot;html.parser&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            homepage = soup.find_all(</span><span class=\"mtk8\">&quot;a&quot;</span><span class=\"mtk1\">, {</span><span class=\"mtk8\">&quot;class&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;str_tit&quot;</span><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            indexing = </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> idxx, val </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">enumerate</span><span class=\"mtk1\">(homepage):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> idxx % </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">continue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                openUrl = urllib.request.urlopen(mainUrl + homepage[idxx][</span><span class=\"mtk8\">&quot;href&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                newUrl = openUrl.geturl()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                newResponse = requests.get(newUrl)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                newHtml = newResponse.text</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                newsoup = BeautifulSoup(newHtml, </span><span class=\"mtk8\">&quot;html.parser&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                splitList = newsoup.find_all(</span><span class=\"mtk12\">attrs</span><span class=\"mtk1\">={</span><span class=\"mtk8\">&quot;name&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;description&quot;</span><span class=\"mtk1\">})[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">][</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk8\">&quot;content&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                ].split(</span><span class=\"mtk8\">&quot;,&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                index = </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                indexing += </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> idx, val </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">enumerate</span><span class=\"mtk1\">(splitList):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> idx == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        checksql = </span><span class=\"mtk8\">&quot;SELECT * FROM company WHERE name = </span><span class=\"mtk4\">%s</span><span class=\"mtk8\">&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        res = cursor.execute(checksql, val)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        name = val</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        cursor.fetchall()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> res == </span><span class=\"mtk7\">1</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk15\">break</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> val.find(</span><span class=\"mtk8\">&quot;:&quot;</span><span class=\"mtk1\">) == -</span><span class=\"mtk7\">1</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk15\">continue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;홈페이지&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> val:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            tt = val.split(</span><span class=\"mtk8\">&quot;:&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            cursor.execute(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                                </span><span class=\"mtk8\">&quot;INSERT INTO company(name, homepage) VALUES (</span><span class=\"mtk4\">%s</span><span class=\"mtk8\">, </span><span class=\"mtk4\">%s</span><span class=\"mtk8\">)&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                                (name, tt[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            cursor.fetchall()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            db.commit()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                            </span><span class=\"mtk11\">print</span><span class=\"mtk1\">(</span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;수집했습니다. </span><span class=\"mtk4\">{</span><span class=\"mtk1\">name</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> </span><span class=\"mtk4\">{</span><span class=\"mtk1\">tt[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        index += </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">print</span><span class=\"mtk1\">(response.status_code)</span></span></span></code></pre>\n<h2 id=\"32엑셀로-저장\" style=\"position:relative;\">3.2.엑셀로 저장<a href=\"#32%EC%97%91%EC%85%80%EB%A1%9C-%EC%A0%80%EC%9E%A5\" aria-label=\"32엑셀로 저장 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>아주 간단하다. DB에 저장된 것들 불러와서<br>\n엑셀에 기록하고 저장 끝.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"python\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        cursor.execute(</span><span class=\"mtk8\">&quot;SELECT * from company&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        result = cursor.fetchall()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        write_wb = Workbook()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        write_st = write_wb.active</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> idx, data </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">enumerate</span><span class=\"mtk1\">(result):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            write_st.cell(</span><span class=\"mtk12\">row</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\"> + idx, </span><span class=\"mtk12\">column</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">).value = data[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            write_st.cell(</span><span class=\"mtk12\">row</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\"> + idx, </span><span class=\"mtk12\">column</span><span class=\"mtk1\">=</span><span class=\"mtk7\">2</span><span class=\"mtk1\">).value = data[</span><span class=\"mtk7\">2</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            write_wb.save(</span><span class=\"mtk8\">&quot;test.xlsx&quot;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h2 id=\"33-메일보내기\" style=\"position:relative;\">3.3. 메일보내기<a href=\"#33-%EB%A9%94%EC%9D%BC%EB%B3%B4%EB%82%B4%EA%B8%B0\" aria-label=\"33 메일보내기 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>홈페이지에 들어가서 메일을 직접 수집했다.<br>\n크롤링을 통해 할 수 있었지만,</p>\n<p>무분별한 메일 수집을 원치 않는 회사들도 있기 때문에<br>\nContact Us에 적어놓은 메일만 수집했다.</p>\n<p>메일에 html로 Contact Us 버튼을 삽입하여,<br>\n클릭 시 FORM 입력 페이지로 넘어가게끔 해놨다.<br>\n그리고 사용자가 FORM을 제출하면 나에게 메일이 오게끔 하여,<br>\n폼을 입력했을 때 즉각 반응할 수 있게 시스템을 구성했다.</p>\n<h1 id=\"4-마치며\" style=\"position:relative;\">4. 마치며<a href=\"#4-%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"4 마치며 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>일부 코드는 공개하지 않았음을 알리고,<br>\n목적에 맞게 가벼운 코드를 짰기 때문에,<br>\n코드 품질과 속도는 신경쓰지 않았다.</p>\n<p>파이썬을 처음 사용해봤는데, 간단하고 직관적이라 좋았다.</p>\n<p>또한 시스템 에러가 났을 때<br>\n먼저 알 수 있도록 메일이나 문자를 보낼 수 있도록 코드를 짜놓는 것에 대해 생각했다.<br>\n결함일 때 과연 메일이나 문자를 전송하는 코드가 실행이 될까라는 의문을 해결하기 위해서는<br>\n외부 모니터링 시스템에 시스템을 구축해놓는 게 좋을 듯하다.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk10 { color: #4EC9B0; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","featuredImg":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQoz2NgMC3+T1WMIWBSBKaZzEoIa4aqxW0gTIFR4X8GnVxUceOi/4xmxWDMYFwI5mM1FMMGo8L//I7V/3UjuiEa9fP/M5mX/Oe1r4JYop//n9Om4j+bVRlhF4I0Mmjn/PcpnPN/86Gr/wv7N/4vn7zlf8WULWC6ee7u/0nNK/9XTt3636dw7n8GrWzMoEHmgL2jl/ffMKbvv3nixP9OmdP/h1cu+t8+f+//lrm7/xf1b/wf37D8f0zd0v+2qVP+M+jm/mfEZyDcC4YFYK8xGOSDXSHkXPNfyrPxP4NaJlS8AKKGqDCEKgBHACy2QWFpWPCf2bwELk5cLONJGoy4DCDZQBIxAEmdXXW0+JVyAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/4426ce2411d81c7f980d95559b7036a4/17c4b/project.png","srcSet":"/static/4426ce2411d81c7f980d95559b7036a4/69585/project.png 200w,\n/static/4426ce2411d81c7f980d95559b7036a4/497c6/project.png 400w,\n/static/4426ce2411d81c7f980d95559b7036a4/17c4b/project.png 743w","sizes":"(max-width: 743px) 100vw, 743px"}}},"frontmatter":{"date":"January 12, 2022","subtitle":"사람인 크롤링 && 메일 보내기 && 디자인","title":"YOGO 마케팅 프로젝트_1차"},"headings":[{"depth":1,"id":"1-디자인","value":"1. 디자인"},{"depth":1,"id":"2-Contact-페이지-배포","value":"2. Contact 페이지 배포"},{"depth":1,"id":"3-사람인-크롤링","value":"3. 사람인 크롤링"},{"depth":2,"id":"31-회사명-홈페이지-주소-수집","value":"3.1. 회사명, 홈페이지 주소 수집"},{"depth":2,"id":"32엑셀로-저장","value":"3.2.엑셀로 저장"},{"depth":2,"id":"33-메일보내기","value":"3.3. 메일보내기"},{"depth":1,"id":"4-마치며","value":"4. 마치며"}]}},"pageContext":{"slug":"/Project/crawling_saramin/"}},"staticQueryHashes":[]}